(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91712,       2027]
NotebookOptionsPosition[     89998,       1992]
NotebookOutlinePosition[     90363,       2008]
CellTagsIndexPosition[     90320,       2005]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Homework-2 :Discrete Geometry
\
\>", "Title",
 CellChangeTimes->{{3.746997502679221*^9, 
  3.7469975200491743`*^9}},ExpressionUUID->"4b370792-d243-4097-bb1e-\
9a3cd9789aaa"],

Cell[CellGroupData[{

Cell["\<\
Part 1: Barycentric Coordinates
\
\>", "Chapter",
 CellChangeTimes->{{3.7469975453311815`*^9, 
  3.7469975603030186`*^9}},ExpressionUUID->"5aa7b981-d2ec-45da-8141-\
1737ba0a6862"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "to", " ", "calculate", " ", "the", " ", "neighbour", " ",
     "triangles", " ", "of", " ", "set", " ", "of", " ", "triangles"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NeighbourFunction", "[", 
      RowBox[{"pts_", ",", "tris_", ",", "noTris_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "a1", ",", "b1", ",", "c1", ",", 
         RowBox[{"numtris", "=", "noTris"}], ",", 
         RowBox[{"result", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "numtris"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"t1", "=", "1"}], ",", 
          RowBox[{"t1", "\[LessEqual]", "numtris"}], ",", 
          RowBox[{"t1", "=", 
           RowBox[{"t1", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "=", 
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"tris", "[", 
               RowBox[{"[", 
                RowBox[{"t1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"b", "=", 
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"tris", "[", 
               RowBox[{"[", 
                RowBox[{"t1", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"tris", "[", 
               RowBox[{"[", 
                RowBox[{"t1", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"t2", "=", "1"}], ",", 
             RowBox[{"t2", "\[LessEqual]", "numtris"}], ",", 
             RowBox[{"t2", "=", 
              RowBox[{"t2", "+", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"t1", "\[NotEqual]", "t2"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"a1", "=", 
                  RowBox[{"pts", "[", 
                   RowBox[{"[", 
                    RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"t2", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"b1", "=", 
                  RowBox[{"pts", "[", 
                   RowBox[{"[", 
                    RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"t2", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"c1", "=", 
                  RowBox[{"pts", "[", 
                   RowBox[{"[", 
                    RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"t2", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a1", ",", "b1", ",", "c1"}], "}"}]}], "]"}], 
                    "]"}], "\[Equal]", "2"}], ",", 
                   RowBox[{"PrependTo", "[", 
                    RowBox[{
                    RowBox[{"result", "[", 
                    RowBox[{"[", "t1", "]"}], "]"}], ",", "t2"}], "]"}]}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "result"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7470049953768773`*^9, 3.747005055237352*^9}, {
   3.7470051765349607`*^9, 3.747005227675456*^9}, {3.7470053367110405`*^9, 
   3.747005397308546*^9}, {3.747015245933696*^9, 3.747015250515238*^9}, {
   3.7470152911176157`*^9, 3.7470153030098033`*^9}, 3.7470153343700833`*^9, {
   3.747022007364908*^9, 3.7470220364890685`*^9}, 3.7470223883941584`*^9, {
   3.747024421924423*^9, 3.747024475290842*^9}, {3.747024945674049*^9, 
   3.7470249736780434`*^9}, 3.747025040334417*^9, {3.7470251014734917`*^9, 
   3.747025284188378*^9}, {3.747025332051429*^9, 3.7470253957386217`*^9}, 
   3.748119790273484*^9, {3.748119944241712*^9, 3.7481199574278708`*^9}, {
   3.7481213455580573`*^9, 3.7481213568691397`*^9}, 3.748121404273054*^9, {
   3.7481219626158185`*^9, 3.7481220158532076`*^9}, {3.748122065514462*^9, 
   3.74812210152738*^9}, {3.748122235316444*^9, 3.7481222699373255`*^9}, {
   3.7481223870273542`*^9, 3.748122494022154*^9}, {3.748122529907075*^9, 
   3.7481225751802635`*^9}, {3.748122638069848*^9, 3.7481226700987024`*^9}, {
   3.7481227740568967`*^9, 3.748122776742297*^9}, {3.7481229651942015`*^9, 
   3.7481229665108376`*^9}, {3.748124093567193*^9, 3.748124172194854*^9}, {
   3.7481243912551737`*^9, 3.7481244010848083`*^9}, {3.748124453210476*^9, 
   3.7481245251944284`*^9}, 3.74812461814858*^9, {3.7481246689596033`*^9, 
   3.7481247527401896`*^9}, {3.7481252917116632`*^9, 
   3.7481253614643173`*^9}, {3.748125418650493*^9, 3.7481254261171837`*^9}, {
   3.7481255068795567`*^9, 3.748125588736292*^9}, {3.7481258413712664`*^9, 
   3.7481258912904577`*^9}, 3.748125923213194*^9, {3.748126042897382*^9, 
   3.7481260472086706`*^9}, {3.7481260865871916`*^9, 
   3.7481261087699947`*^9}, {3.748126155274047*^9, 3.7481261977921705`*^9}, {
   3.7481263144267592`*^9, 3.7481263170608673`*^9}, {3.7481264232738423`*^9, 
   3.7481264470207443`*^9}, {3.7481269067559423`*^9, 
   3.7481269991103115`*^9}, {3.748127038031306*^9, 3.7481270450554905`*^9}, {
   3.7481271161915436`*^9, 3.7481272103491306`*^9}, 3.748127364923375*^9, {
   3.7481274531335287`*^9, 3.748127454961747*^9}, {3.7481275623105526`*^9, 
   3.748127565982591*^9}, {3.7481284489431334`*^9, 3.748128451049096*^9}, {
   3.748128519624877*^9, 3.74812854477343*^9}, {3.7481285998377075`*^9, 
   3.748128610234397*^9}, 3.748128664038216*^9, {3.7481287163101482`*^9, 
   3.748128735868167*^9}, {3.7481288223403053`*^9, 3.7481288539904013`*^9}, {
   3.7481317289870024`*^9, 3.7481318268802648`*^9}, {3.748139024827222*^9, 
   3.7481390299856377`*^9}, {3.748139062764346*^9, 3.74813908279464*^9}, {
   3.7482081047342196`*^9, 3.7482081056838493`*^9}, {3.748208229329247*^9, 
   3.7482082660037737`*^9}, {3.74820830890797*^9, 3.7482083236209393`*^9}, {
   3.748208397517381*^9, 3.7482084903603396`*^9}, {3.748208719170594*^9, 
   3.7482087845237885`*^9}, {3.7482088857363477`*^9, 
   3.7482089110308733`*^9}, {3.7482089454636*^9, 3.748208984226387*^9}, {
   3.7482090157412357`*^9, 3.7482090235534987`*^9}, {3.7482090573894553`*^9, 
   3.748209062023857*^9}, {3.7482090940404167`*^9, 3.7482091222720613`*^9}, {
   3.7482092004803605`*^9, 3.7482092031246233`*^9}, {3.7482092751328835`*^9, 
   3.7482093716789227`*^9}, 3.7482094209061327`*^9, {3.7482094551798296`*^9, 
   3.748209466948549*^9}, {3.7482095641669044`*^9, 3.748209577600169*^9}, {
   3.748209609451047*^9, 3.7482096524515543`*^9}, {3.748209697652813*^9, 
   3.748209701045143*^9}, {3.74820973147821*^9, 3.748209842245578*^9}, {
   3.748209877044039*^9, 3.748209892994272*^9}, {3.7482099274514446`*^9, 
   3.748209983183875*^9}, {3.7482100216478405`*^9, 3.748210029946803*^9}, {
   3.7482100644501743`*^9, 3.7482101429491587`*^9}, {3.748210250695317*^9, 
   3.7482102512901635`*^9}, {3.7482103404915*^9, 3.7482103894496746`*^9}, {
   3.7482104545852375`*^9, 3.7482105117933464`*^9}, {3.7482105731021943`*^9, 
   3.748210607900131*^9}, {3.74821083271535*^9, 3.7482108455954485`*^9}, {
   3.748210907488566*^9, 3.7482109691177826`*^9}, {3.748211404952052*^9, 
   3.7482115063517504`*^9}, {3.7482115509984365`*^9, 3.748211558194516*^9}, 
   3.748211591307559*^9, {3.7482116820454397`*^9, 3.7482117804816446`*^9}, {
   3.748211823678219*^9, 3.7482118374622955`*^9}, {3.748211868069646*^9, 
   3.7482118767326207`*^9}, {3.748211922196831*^9, 3.748211928837549*^9}, {
   3.748211974135204*^9, 3.7482121244923034`*^9}, {3.748212179288335*^9, 
   3.7482122085595074`*^9}, {3.748264101293011*^9, 3.7482641129505577`*^9}, {
   3.7482641561960807`*^9, 3.7482641612069826`*^9}, {3.7482642541162157`*^9, 
   3.748264254952422*^9}, {3.7482644235131454`*^9, 3.7482644501434803`*^9}, {
   3.748306189750992*^9, 3.7483063326934285`*^9}, {3.7483063727048235`*^9, 
   3.7483063778512316`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"383b79bd-8ca3-4b26-a5c4-4a7f2920a303"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"numpts", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Create", " ", "a", " ", "random", " ", "point", " ", "set"}], 
    "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"pts", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"numpts", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dmesh", " ", "=", " ", 
     RowBox[{"DelaunayMesh", "[", "pts", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tris", " ", "=", " ", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"dmesh", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numtris", " ", "=", " ", 
     RowBox[{"Length", "[", "tris", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Number of triangles numtris = \>\"", ",", "numtris"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Tri \>\"", ",", "i", ",", "\[IndentingNewLine]", "\"\< v1=\>\"", 
        ",", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"tris", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", "\"\< v2=\>\"", ",", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"tris", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", "\"\< v3 = \>\"", ",", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"tris", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "numtris"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.747001607306515*^9, 3.7470017209937925`*^9}, {
   3.74700188981858*^9, 3.7470019137964582`*^9}, 3.7470034193982506`*^9, {
   3.747003457252366*^9, 3.747003516159836*^9}, {3.7470035882519827`*^9, 
   3.7470036366740685`*^9}, {3.7470036715018044`*^9, 
   3.7470036912374067`*^9}, {3.7470037324494667`*^9, 3.747003819596571*^9}, {
   3.747004169311695*^9, 3.7470043113994465`*^9}, {3.747004355334277*^9, 
   3.747004417136876*^9}, {3.7470044657890234`*^9, 3.747004602217944*^9}, {
   3.7470048307744455`*^9, 3.7470049629715176`*^9}, {3.7470052524182024`*^9, 
   3.747005327139989*^9}, {3.748119071305064*^9, 3.7481191860416565`*^9}, 
   3.748120258793725*^9, {3.748120395085223*^9, 3.7481204032735343`*^9}, {
   3.748120470576083*^9, 3.748120538995674*^9}, {3.7481212661488867`*^9, 
   3.748121322716459*^9}, {3.7481213651185093`*^9, 3.7481214120849147`*^9}, {
   3.7481220253774323`*^9, 3.748122063622406*^9}, {3.748122805805645*^9, 
   3.74812281527569*^9}, {3.7481228936898146`*^9, 3.748122950091679*^9}, {
   3.74812417602054*^9, 3.748124182678213*^9}, 3.7481274951548133`*^9, {
   3.748313695815939*^9, 3.748313722114129*^9}, {3.7483154642911415`*^9, 
   3.7483154711850915`*^9}},ExpressionUUID->"3f2b1141-2c1e-46b4-a4dd-\
b4557e045414"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "the", " ", "neighbours", " ", "of", " ", "the", " ", 
    "triangles"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"NeighbourFunction", "[", 
      RowBox[{"pts", ",", "tris", ",", "numtris"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "result", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7470049953768773`*^9, 3.747005055237352*^9}, {
   3.7470051765349607`*^9, 3.747005227675456*^9}, {3.7470053367110405`*^9, 
   3.747005397308546*^9}, {3.747015245933696*^9, 3.747015250515238*^9}, {
   3.7470152911176157`*^9, 3.7470153030098033`*^9}, 3.7470153343700833`*^9, {
   3.747022007364908*^9, 3.7470220364890685`*^9}, 3.7470223883941584`*^9, {
   3.747024421924423*^9, 3.747024475290842*^9}, {3.747024945674049*^9, 
   3.7470249736780434`*^9}, 3.747025040334417*^9, {3.7470251014734917`*^9, 
   3.747025284188378*^9}, {3.747025332051429*^9, 3.7470253957386217`*^9}, 
   3.748119790273484*^9, {3.748119944241712*^9, 3.7481199574278708`*^9}, {
   3.748122828727791*^9, 3.74812287402159*^9}, {3.748124185081509*^9, 
   3.7481242149897013`*^9}, {3.748124410155465*^9, 3.7481244111755886`*^9}, {
   3.7481245463174105`*^9, 3.748124605353717*^9}, {3.7481273416618557`*^9, 
   3.7481273567578816`*^9}, {3.7481274803682556`*^9, 3.748127512281708*^9}, {
   3.7481275500706525`*^9, 3.748127712078357*^9}, {3.7481278341194882`*^9, 
   3.748127851170933*^9}, {3.7481278936117907`*^9, 3.7481279269318466`*^9}, {
   3.7481281876164637`*^9, 3.7481282449852376`*^9}, {3.74812828398666*^9, 
   3.748128432170235*^9}, {3.748128463303444*^9, 3.748128473439048*^9}, {
   3.748128905984063*^9, 3.7481292297839303`*^9}, {3.7481292667695866`*^9, 
   3.7481294368209543`*^9}, {3.748129467139167*^9, 3.7481295142325625`*^9}, {
   3.74812955769254*^9, 3.7481295596218224`*^9}, {3.7481295924717264`*^9, 
   3.7481296908713217`*^9}, {3.7481297347185574`*^9, 3.748129753167857*^9}, {
   3.748129792152842*^9, 3.7481297962826004`*^9}, {3.7481302715634537`*^9, 
   3.7481303043653173`*^9}, {3.74813033671789*^9, 3.7481303857835965`*^9}, {
   3.7481304209900675`*^9, 3.7481306035127516`*^9}, {3.7481307576545143`*^9, 
   3.748130803684198*^9}, {3.748130933242569*^9, 3.748131189720868*^9}, {
   3.7481312339608393`*^9, 3.7481312579778476`*^9}, {3.7481314121627865`*^9, 
   3.7481314424159546`*^9}, {3.74813152004771*^9, 3.7481315884403048`*^9}, {
   3.748131720316221*^9, 3.748131723483329*^9}, {3.7481318360673876`*^9, 
   3.748131881181465*^9}, 3.748139274328088*^9, {3.7482088041999817`*^9, 
   3.748208806899802*^9}, {3.748208871956608*^9, 3.7482089009628386`*^9}, {
   3.7482091301487274`*^9, 3.748209189164349*^9}, {3.748211621507584*^9, 
   3.7482116675245295`*^9}, {3.748212140123417*^9, 3.7482121735927324`*^9}, {
   3.748311378730442*^9, 3.748311388949729*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0655997c-bf07-40ca-8a82-97dc34dd521c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7482120582013254`*^9, 3.748212138159733*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"6f3a9a41-4905-4769-b7a9-e37642735dd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Barycentric", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "xy_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "u", ",", "v", ",", "w", ",", "PBC", ",", "PAC", ",", "PAB", ",", 
        RowBox[{"bc", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calculate", " ", "barycentric", " ", "coordinates", " ", "of", " ", 
        "a", " ", "triangle"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"PBC", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"c", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"c", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", "\n", 
       RowBox[{"u", "=", 
        RowBox[{"0.5", " ", "*", " ", 
         RowBox[{"Det", "[", "PBC", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PAC", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"c", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"c", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", "\n", 
       RowBox[{"v", "=", 
        RowBox[{"0.5", " ", "*", " ", 
         RowBox[{"Det", "[", "PAC", "]"}]}]}], ";", "\n", 
       RowBox[{"PAB", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"b", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"xy", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", "\n", 
       RowBox[{"w", "=", 
        RowBox[{"0.5", " ", "*", " ", 
         RowBox[{"Det", "[", "PAB", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"bc", ",", "u"}], "]"}], ";", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"bc", ",", "v"}], "]"}], ";", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"bc", ",", "w"}], "]"}], ";", "\[IndentingNewLine]", "bc"}]}],
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7470049953768773`*^9, 3.747005055237352*^9}, {
   3.7470051765349607`*^9, 3.747005227675456*^9}, {3.7470053367110405`*^9, 
   3.747005397308546*^9}, {3.747015245933696*^9, 3.747015250515238*^9}, {
   3.7470152911176157`*^9, 3.7470153030098033`*^9}, 3.7470153343700833`*^9, {
   3.747022007364908*^9, 3.7470220364890685`*^9}, 3.7470223883941584`*^9, {
   3.747024421924423*^9, 3.747024475290842*^9}, {3.747024945674049*^9, 
   3.7470249736780434`*^9}, 3.747025040334417*^9, {3.7470251014734917`*^9, 
   3.747025284188378*^9}, {3.747025332051429*^9, 3.7470253957386217`*^9}, 
   3.748119790273484*^9, {3.748119944241712*^9, 3.7481199574278708`*^9}, {
   3.748122828727791*^9, 3.74812287402159*^9}, {3.748124185081509*^9, 
   3.7481242149897013`*^9}, {3.748124410155465*^9, 3.7481244111755886`*^9}, {
   3.7481245463174105`*^9, 3.748124605353717*^9}, {3.7481273416618557`*^9, 
   3.7481273567578816`*^9}, {3.7481274803682556`*^9, 3.748127512281708*^9}, {
   3.7481275500706525`*^9, 3.748127712078357*^9}, {3.7481278341194882`*^9, 
   3.748127851170933*^9}, {3.7481278936117907`*^9, 3.7481279269318466`*^9}, {
   3.7481281876164637`*^9, 3.7481282449852376`*^9}, {3.74812828398666*^9, 
   3.748128432170235*^9}, {3.748128463303444*^9, 3.748128473439048*^9}, {
   3.748128905984063*^9, 3.7481292297839303`*^9}, {3.7481292667695866`*^9, 
   3.7481294368209543`*^9}, {3.748129467139167*^9, 3.7481295142325625`*^9}, {
   3.74812955769254*^9, 3.7481295596218224`*^9}, {3.7481295924717264`*^9, 
   3.7481296908713217`*^9}, {3.7481297347185574`*^9, 3.748129753167857*^9}, {
   3.748129792152842*^9, 3.7481297962826004`*^9}, {3.7481302715634537`*^9, 
   3.7481303043653173`*^9}, {3.74813033671789*^9, 3.7481303857835965`*^9}, {
   3.7481304209900675`*^9, 3.7481306035127516`*^9}, {3.7481307576545143`*^9, 
   3.748130803684198*^9}, {3.748130933242569*^9, 3.748131189720868*^9}, {
   3.7481312339608393`*^9, 3.7481312579778476`*^9}, {3.7481314121627865`*^9, 
   3.7481314424159546`*^9}, {3.74813152004771*^9, 3.7481315884403048`*^9}, {
   3.748131720316221*^9, 3.748131723483329*^9}, {3.7481318360673876`*^9, 
   3.748131881181465*^9}, 3.748139274328088*^9, 3.748205533698442*^9, {
   3.748312776756742*^9, 3.7483128109615955`*^9}, {3.7483130072342744`*^9, 
   3.7483130233132296`*^9}, {3.7483140170300665`*^9, 3.748314017686349*^9}, {
   3.748315483236636*^9, 
   3.7483154965407777`*^9}},ExpressionUUID->"af4564f0-1436-4e32-9e5c-\
b861498acc76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findPath", "[", 
     RowBox[{"p_", ",", "currentTri_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", 
        RowBox[{"current", "=", "currentTri"}], ",", 
        RowBox[{"reslist", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"reslist", ",", "current"}], "]"}], ";", 
       "                                ", 
       RowBox[{"(*", 
        RowBox[{
        "add", " ", "current", " ", "triangle", " ", "to", " ", "the", " ", 
         "path"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"tris", "[", 
           RowBox[{"[", 
            RowBox[{"current", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"tris", "[", 
           RowBox[{"[", 
            RowBox[{"current", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", " ", 
       RowBox[{"c", "=", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"tris", "[", 
           RowBox[{"[", 
            RowBox[{"current", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"bary", "=", 
        RowBox[{"Barycentric", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "p"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"find", " ", "the", " ", "barycentric", " ", "coordinates"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"bary", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"v", "=", 
        RowBox[{"bary", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"w", "=", 
        RowBox[{"bary", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "u", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "v", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "w", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "<", "0"}], "||", 
          RowBox[{"v", "<", "0"}], "||", 
          RowBox[{"w", "<", "0"}]}], ",", "         ", 
         RowBox[{"(*", 
          RowBox[{
          "if", " ", "not", " ", "inside", " ", "the", " ", "triangle"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"minpos", "=", 
           RowBox[{"Position", "[", 
            RowBox[{"bary", ",", 
             RowBox[{"Min", "[", "bary", "]"}]}], "]"}]}], ";", "   ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Find", " ", "the", " ", "position", " ", "of", " ", "min", " ", 
             "of", " ", "u"}], ",", "v", ",", "w"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"minpos", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"neighbor", "=", 
              RowBox[{"result", "[", 
               RowBox[{"[", "current", "]"}], "]"}]}], ";", 
             "                                     ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"In", " ", "case", " ", "u", " ", "is", " ", "min"}], 
               ",", 
               RowBox[{
               "Find", " ", "the", " ", "neighbour", " ", "that", " ", 
                "shares", " ", "edge", " ", "bc"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "Do", "[", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{
               RowBox[{
                RowBox[{"b1", "=", 
                 RowBox[{"pts", "[", 
                  RowBox[{"[", 
                   RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "          ", 
                RowBox[{"c1", "=", 
                 RowBox[{"pts", "[", 
                  RowBox[{"[", 
                   RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\t", 
                "\[IndentingNewLine]", "         ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"b1", ",", "c1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "c", ",", "b"}], "}"}]}], "]"}], "]"}], 
                   "\[Equal]", "2"}], ",", 
                  RowBox[{"current", "=", "i"}]}], " ", "]"}], ";"}], 
               "\[IndentingNewLine]", "         ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "neighbor"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"minpos", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "2"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"neighbor", "=", 
              RowBox[{"result", "[", 
               RowBox[{"[", "current", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{
                RowBox[{"a1", "=", 
                 RowBox[{"pts", "[", 
                  RowBox[{"[", 
                   RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "          ", 
                RowBox[{"c1", "=", 
                 RowBox[{"pts", "[", 
                  RowBox[{"[", 
                   RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
                  "]"}]}], ";", "                          ", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", " ", "v", " ", "is", " ", "min"}], ",", 
                  RowBox[{
                  "Find", " ", "the", " ", "neighbour", " ", "that", " ", 
                   "shares", " ", "edge", " ", "ac"}]}], " ", "*)"}], 
                "\[IndentingNewLine]", "          ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a1", ",", "c1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "c", ",", "b"}], "}"}]}], "]"}], "]"}], 
                   "\[Equal]", "2"}], ",", 
                  RowBox[{"current", "=", "i"}]}], " ", "]"}], ";"}], 
               "\[IndentingNewLine]", "         ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "neighbor"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"minpos", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "3"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"neighbor", "=", 
              RowBox[{"result", "[", 
               RowBox[{"[", "current", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{
                RowBox[{"b1", "=", 
                 RowBox[{"pts", "[", 
                  RowBox[{"[", 
                   RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "          ", 
                RowBox[{"a1", "=", 
                 RowBox[{"pts", "[", 
                  RowBox[{"[", 
                   RowBox[{"tris", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
                  "]"}]}], ";", "                  ", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", " ", "w", " ", "is", " ", "min"}], ",", 
                  RowBox[{
                  "Find", " ", "the", " ", "neighbour", " ", "that", " ", 
                   "shares", " ", "edge", " ", "ab"}]}], " ", "*)"}], 
                "\[IndentingNewLine]", "          ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"b1", ",", "a1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "c", ",", "b"}], "}"}]}], "]"}], "]"}], 
                   "\[Equal]", "2"}], ",", 
                  RowBox[{"current", "=", "i"}]}], " ", "]"}], ";"}], 
               "\[IndentingNewLine]", "         ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "neighbor"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"reslist", ",", "current"}], "]"}], ";", 
          "                                ", 
          RowBox[{"(*", 
           RowBox[{
           "add", " ", "current", " ", "triangle", " ", "to", " ", "the", " ",
             "path"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"a", "=", 
           RowBox[{"pts", "[", 
            RowBox[{"[", 
             RowBox[{"tris", "[", 
              RowBox[{"[", 
               RowBox[{"current", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"pts", "[", 
            RowBox[{"[", 
             RowBox[{"tris", "[", 
              RowBox[{"[", 
               RowBox[{"current", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", " ", 
          RowBox[{"c", "=", 
           RowBox[{"pts", "[", 
            RowBox[{"[", 
             RowBox[{"tris", "[", 
              RowBox[{"[", 
               RowBox[{"current", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"bary", "=", 
           RowBox[{"Barycentric", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "p"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"u", "=", 
           RowBox[{"bary", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{"v", "=", 
           RowBox[{"bary", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", 
          RowBox[{"w", "=", 
           RowBox[{"bary", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"end", " ", "of", " ", "while"}], "*)"}], 
       "\[IndentingNewLine]", "reslist"}]}], "]"}]}], ";"}], "       ", 
  RowBox[{"(*", 
   RowBox[{
   "returns", " ", "a", " ", "list", " ", "of", " ", "triangles", " ", "as", 
    " ", "path", " ", "to", " ", "point"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7470049953768773`*^9, 3.747005055237352*^9}, {
   3.7470051765349607`*^9, 3.747005227675456*^9}, {3.7470053367110405`*^9, 
   3.747005397308546*^9}, {3.747015245933696*^9, 3.747015250515238*^9}, {
   3.7470152911176157`*^9, 3.7470153030098033`*^9}, 3.7470153343700833`*^9, {
   3.747022007364908*^9, 3.7470220364890685`*^9}, 3.7470223883941584`*^9, {
   3.747024421924423*^9, 3.747024475290842*^9}, {3.747024945674049*^9, 
   3.7470249736780434`*^9}, 3.747025040334417*^9, {3.7470251014734917`*^9, 
   3.747025284188378*^9}, {3.747025332051429*^9, 3.7470253957386217`*^9}, 
   3.748119790273484*^9, {3.748119944241712*^9, 3.7481199574278708`*^9}, {
   3.748122828727791*^9, 3.74812287402159*^9}, {3.748124185081509*^9, 
   3.7481242149897013`*^9}, {3.748124410155465*^9, 3.7481244111755886`*^9}, {
   3.7481245463174105`*^9, 3.748124605353717*^9}, {3.7481273416618557`*^9, 
   3.7481273567578816`*^9}, {3.7481274803682556`*^9, 3.748127512281708*^9}, {
   3.7481275500706525`*^9, 3.748127712078357*^9}, {3.7481278341194882`*^9, 
   3.748127851170933*^9}, {3.7481278936117907`*^9, 3.7481279269318466`*^9}, {
   3.7481281876164637`*^9, 3.7481282449852376`*^9}, {3.74812828398666*^9, 
   3.748128432170235*^9}, {3.748128463303444*^9, 3.748128473439048*^9}, {
   3.748128905984063*^9, 3.7481292297839303`*^9}, {3.7481292667695866`*^9, 
   3.7481294368209543`*^9}, {3.748129467139167*^9, 3.7481295142325625`*^9}, {
   3.74812955769254*^9, 3.7481295596218224`*^9}, {3.7481295924717264`*^9, 
   3.7481296908713217`*^9}, {3.7481297347185574`*^9, 3.748129753167857*^9}, {
   3.748129792152842*^9, 3.7481297962826004`*^9}, {3.7481302715634537`*^9, 
   3.7481303043653173`*^9}, {3.74813033671789*^9, 3.7481303857835965`*^9}, {
   3.7481304209900675`*^9, 3.7481306035127516`*^9}, {3.7481307576545143`*^9, 
   3.748130803684198*^9}, {3.748130933242569*^9, 3.748131189720868*^9}, {
   3.7481312339608393`*^9, 3.7481312579778476`*^9}, {3.7481314121627865`*^9, 
   3.7481314424159546`*^9}, {3.74813152004771*^9, 3.7481315884403048`*^9}, {
   3.748131720316221*^9, 3.748131723483329*^9}, {3.7481318360673876`*^9, 
   3.748131881181465*^9}, 3.748139274328088*^9, {3.748205533698442*^9, 
   3.748205554304706*^9}, {3.7483066806306562`*^9, 3.748306688218233*^9}, {
   3.748306821768217*^9, 3.748306823446715*^9}, {3.7483070236609535`*^9, 
   3.748307023832867*^9}, 3.7483070563901873`*^9, {3.748307089140458*^9, 
   3.748307146036233*^9}, {3.7483072724498296`*^9, 3.7483072984709206`*^9}, {
   3.7483073368521233`*^9, 3.7483073506111045`*^9}, {3.7483074118869376`*^9, 
   3.748307438683527*^9}, {3.748307575740055*^9, 3.7483077545304375`*^9}, {
   3.748307972050829*^9, 3.7483080380747776`*^9}, 3.7483081176732903`*^9, {
   3.7483081925225844`*^9, 3.748308239659139*^9}, {3.7483082806676188`*^9, 
   3.7483083012188997`*^9}, {3.7483083451638594`*^9, 
   3.7483084054702816`*^9}, {3.7483085380999603`*^9, 
   3.7483086082324843`*^9}, {3.748308779018137*^9, 3.7483088621300793`*^9}, {
   3.7483089298083115`*^9, 3.7483091693686905`*^9}, {3.748309226639661*^9, 
   3.748309357776553*^9}, {3.7483094164778147`*^9, 3.7483095085090914`*^9}, {
   3.748309553308765*^9, 3.7483095636351795`*^9}, {3.748309670425289*^9, 
   3.74830967713064*^9}, {3.748309729786603*^9, 3.748309792596175*^9}, {
   3.7483098737526236`*^9, 3.7483099485174465`*^9}, {3.7483099830898385`*^9, 
   3.7483100162361813`*^9}, {3.7483100723025117`*^9, 3.748310082488331*^9}, {
   3.7483102942650924`*^9, 3.748310294999504*^9}, {3.7483104382567086`*^9, 
   3.7483105356841455`*^9}, 3.7483108219486313`*^9, {3.748310945057926*^9, 
   3.7483109661527615`*^9}, {3.748311068137354*^9, 3.748311085794488*^9}, {
   3.7483111302654653`*^9, 3.7483112141915674`*^9}, {3.7483112585687904`*^9, 
   3.748311359526972*^9}, {3.7483115040335927`*^9, 3.748311513612198*^9}, {
   3.7483115674586396`*^9, 3.748311571474496*^9}, {3.7483116114764977`*^9, 
   3.74831165532242*^9}, {3.7483119501539793`*^9, 3.7483120243608217`*^9}, {
   3.748312098520794*^9, 3.7483121498358397`*^9}, {3.7483122016822114`*^9, 
   3.748312405942441*^9}, {3.748312458210683*^9, 3.7483125511215863`*^9}, {
   3.7483126149528847`*^9, 3.7483126549080353`*^9}, {3.7483128218840103`*^9, 
   3.7483128413068657`*^9}, 3.7483129435592203`*^9, {3.7483130320948906`*^9, 
   3.7483130398921604`*^9}, {3.748313197509729*^9, 3.7483134896181374`*^9}, {
   3.7483135759037075`*^9, 3.7483135940296164`*^9}, {3.7483139552456975`*^9, 
   3.7483139665743904`*^9}, {3.748314117003799*^9, 3.748314177209937*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3ea02795-7455-4cca-8962-7c89dadc849a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "path", " ", "to", " ", "point"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"currentTri", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findPoint", " ", "=", " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", "numpts", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotPoints", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"pts", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "numpts"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotTris", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", "White", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"tris", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
              "]"}], ",", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"tris", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
              "]"}], ",", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"tris", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
              "]"}]}], "}"}], "]"}]}], "}"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "numtris"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"movingPoint", " ", "=", " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", " ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<pos  -\>\"", ",", "xy"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plotMovingPoint", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Red", ",", 
           RowBox[{"Point", "[", "xy", "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "call", " ", "findPath", " ", "that", " ", "returns", " ", "a", " ", 
         "list", " ", "of", " ", "triangles", " ", "in", " ", "the", " ", 
         "path"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
       RowBox[{"plotPath", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", "Blue", ",", 
             RowBox[{"Polygon", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"tris", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"tris", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"pts", "[", 
                 RowBox[{"[", 
                  RowBox[{"tris", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
                 "]"}]}], "}"}], "]"}]}], "}"}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"findPath", "[", 
             RowBox[{"xy", ",", "currentTri"}], "]"}]}], "}"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"{", 
         RowBox[{
         "plotTris", ",", "plotPoints", ",", " ", "plotMovingPoint", " ", ",",
           "plotPath"}], "}"}], "]"}]}], "\[IndentingNewLine]", ")"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy", ",", "movingPoint"}], "}"}], ",", " ", "Locator"}], 
      "}"}]}], "]"}], "\[IndentingNewLine]", "  ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7470049953768773`*^9, 3.747005055237352*^9}, {
   3.7470051765349607`*^9, 3.747005227675456*^9}, {3.7470053367110405`*^9, 
   3.747005397308546*^9}, {3.747015245933696*^9, 3.747015250515238*^9}, {
   3.7470152911176157`*^9, 3.7470153030098033`*^9}, 3.7470153343700833`*^9, {
   3.7470159353921804`*^9, 3.747015953332322*^9}, {3.7481392615325327`*^9, 
   3.7481392708854923`*^9}, {3.748139513434376*^9, 3.7481395208758445`*^9}, {
   3.748139624583036*^9, 3.7481396763438683`*^9}, 3.748142095806926*^9, {
   3.7481425467005167`*^9, 3.7481425599273353`*^9}, {3.748142603025071*^9, 
   3.748142620922003*^9}, {3.7481426537618914`*^9, 3.7481427118286023`*^9}, {
   3.748143056526405*^9, 3.7481430902318754`*^9}, 3.748143143765565*^9, {
   3.748143484801918*^9, 3.7481435226731653`*^9}, 3.7481456003294296`*^9, 
   3.748145745193119*^9, {3.7481853971070943`*^9, 3.7481854125993757`*^9}, {
   3.7481879891486735`*^9, 3.7481880292815742`*^9}, {3.748188249194436*^9, 
   3.748188343521722*^9}, {3.748188418345373*^9, 3.748188453373931*^9}, {
   3.748188483605251*^9, 3.748188484667797*^9}, {3.748188578290157*^9, 
   3.748188655661951*^9}, {3.7481891271275826`*^9, 3.7481891440936003`*^9}, 
   3.748189207278572*^9, {3.7481893747554913`*^9, 3.74818945193285*^9}, {
   3.748189493547437*^9, 3.7481895748332233`*^9}, {3.7481897616505995`*^9, 
   3.74818980026777*^9}, {3.748189925287834*^9, 3.748189937078749*^9}, {
   3.748189967183465*^9, 3.74819012181607*^9}, {3.7481902015618744`*^9, 
   3.748190309225358*^9}, {3.7481904396955547`*^9, 3.7481905011235065`*^9}, {
   3.7481914816905966`*^9, 3.7481915558317537`*^9}, {3.748191586369104*^9, 
   3.748191588450349*^9}, {3.7481918003972197`*^9, 3.748191868490615*^9}, {
   3.748191932875538*^9, 3.7481919510336485`*^9}, {3.74819217839768*^9, 
   3.748192312274931*^9}, {3.748192357770183*^9, 3.7481923757083807`*^9}, {
   3.7481924137518883`*^9, 3.748192555203307*^9}, {3.748192949415263*^9, 
   3.7481929624867153`*^9}, {3.748198522558142*^9, 3.7481985379243126`*^9}, {
   3.7481986400863724`*^9, 3.7481986446064887`*^9}, {3.7481986768226027`*^9, 
   3.748198753704739*^9}, {3.7481997456442647`*^9, 3.748199755787608*^9}, {
   3.748199961099552*^9, 3.7481999943196917`*^9}, {3.7482000391762376`*^9, 
   3.7482000511101894`*^9}, {3.748200247222015*^9, 3.7482002908340893`*^9}, {
   3.7482006602625113`*^9, 3.74820067655818*^9}, {3.7482007894876738`*^9, 
   3.748200850361208*^9}, {3.7482009508244753`*^9, 3.7482009676799164`*^9}, {
   3.748201039955797*^9, 3.7482010769031696`*^9}, {3.7482013197542377`*^9, 
   3.748201449533473*^9}, {3.7482014798129373`*^9, 3.748201481064034*^9}, {
   3.7482020073839264`*^9, 3.7482020624638524`*^9}, {3.7482021000868473`*^9, 
   3.7482021672542334`*^9}, {3.748202203392335*^9, 3.74820236463696*^9}, {
   3.7482024577356563`*^9, 3.7482025570557723`*^9}, 3.7482026252111187`*^9, {
   3.7482027632245703`*^9, 3.7482029537873673`*^9}, 3.7482030022658677`*^9, {
   3.7482030353979516`*^9, 3.7482030356161013`*^9}, {3.7482030760010247`*^9, 
   3.748203187740518*^9}, {3.74820329804105*^9, 3.7482033096487894`*^9}, {
   3.7482033548869495`*^9, 3.7482034447768745`*^9}, {3.748203482091751*^9, 
   3.74820357684492*^9}, {3.7482036199536605`*^9, 3.748203629901292*^9}, {
   3.7482036623479223`*^9, 3.748203858407824*^9}, {3.7482039693551702`*^9, 
   3.7482040022465906`*^9}, {3.7482040477928233`*^9, 
   3.7482040479803486`*^9}, {3.7482040952524757`*^9, 3.748204192644035*^9}, {
   3.7482042857206173`*^9, 3.7482046125227733`*^9}, {3.748204657202154*^9, 
   3.7482046977510123`*^9}, {3.748204739927081*^9, 3.7482048362505217`*^9}, {
   3.748204872356575*^9, 3.7482049083321943`*^9}, 3.74820496678388*^9, {
   3.7482050190463696`*^9, 3.7482050279248962`*^9}, {3.7482050884233103`*^9, 
   3.7482050942825356`*^9}, {3.7482051472522817`*^9, 3.748205149657137*^9}, {
   3.7482052005782604`*^9, 3.7482052175020347`*^9}, {3.748205309767085*^9, 
   3.748205350246628*^9}, {3.748205384575992*^9, 3.748205385286665*^9}, {
   3.748205424247888*^9, 3.7482054316048136`*^9}, 3.7482054903237495`*^9, {
   3.7482055302991257`*^9, 3.748205549239048*^9}, {3.748205591627058*^9, 
   3.7482056133261766`*^9}, {3.748205849034607*^9, 3.748205968157188*^9}, {
   3.7482060068005176`*^9, 3.7482060274381933`*^9}, {3.7482061268838787`*^9, 
   3.7482061880709033`*^9}, {3.7482066616991587`*^9, 
   3.7482066824754534`*^9}, {3.748206725873434*^9, 3.7482067838985186`*^9}, {
   3.7482069206587253`*^9, 3.748206926408141*^9}, {3.7482071083217535`*^9, 
   3.748207130788267*^9}, {3.7482073207773504`*^9, 3.748207331730096*^9}, 
   3.7483064167563844`*^9, {3.7483069044699707`*^9, 3.7483069081393337`*^9}, {
   3.7483071921972437`*^9, 3.748307246166823*^9}, {3.7483084551934495`*^9, 
   3.748308475186986*^9}, {3.7483135414644594`*^9, 3.748313563059306*^9}, {
   3.748313627390662*^9, 3.7483136429539423`*^9}, {3.74831379308646*^9, 
   3.7483138364636335`*^9}, {3.748313895357626*^9, 3.748313909639615*^9}, {
   3.7483142684222374`*^9, 3.7483142741725264`*^9}, {3.748314540910832*^9, 
   3.748314542660943*^9}, {3.748314606492241*^9, 3.748314618508467*^9}, {
   3.748314680511574*^9, 3.748314733154831*^9}, {3.7483147871106853`*^9, 
   3.748314814705809*^9}, {3.7483148634895105`*^9, 3.7483148703492303`*^9}, {
   3.7483149107574787`*^9, 3.7483149122731805`*^9}, {3.7483149482593575`*^9, 
   3.7483149514157662`*^9}, {3.7483149829485955`*^9, 3.748314996871191*^9}, {
   3.7483150411702847`*^9, 3.7483150541552873`*^9}, {3.7483150849224515`*^9, 
   3.7483150924384527`*^9}, {3.7483151245181847`*^9, 
   3.7483151758645306`*^9}, {3.7483152134914064`*^9, 
   3.7483152256951275`*^9}, {3.7483152978950815`*^9, 
   3.7483153030977154`*^9}, {3.748315345370751*^9, 3.7483154053565626`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"ca468cd8-c87c-499a-8522-270d7105c740"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part 2: 3D Triangulation Creation and axes alignment", "Chapter",
 CellChangeTimes->{{3.7483057546017747`*^9, 
  3.748305805155702*^9}},ExpressionUUID->"34763baa-b91a-4e6e-b37e-\
958a9a0333da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "a", " ", "surface"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"surface", ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "u", "]"}], "*", "v"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], "*", "v"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "v", "]"}], "+", "1"}]}], "}"}], "*", "1.0"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Discretize", " ", "a", " ", "2", "d", " ", "domain"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"discretize", "[", 
      RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointset2d", "=", 
         RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"2", "Pi"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", 
            RowBox[{"2", "*", 
             RowBox[{"Pi", "/", "n1"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "0"}], ",", 
            RowBox[{"j", "\[LessEqual]", "2"}], ",", 
            RowBox[{"j", "=", 
             RowBox[{"j", "+", 
              RowBox[{"2", "/", "n2"}]}]}], ",", "\[IndentingNewLine]", "\t", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"pointset2d", ",", 
               RowBox[{"List", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], "]"}], ";"}]}], "\n", 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "pointset2d"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Generate", " ", "3", "D", " ", "point", " ", "cloud"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"discretize3D", "[", 
      RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointset3d", "=", 
         RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"2", "Pi"}]}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", 
            RowBox[{"2", "*", 
             RowBox[{"Pi", "/", "n1"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "0"}], ",", 
            RowBox[{"j", "\[LessEqual]", "2"}], ",", 
            RowBox[{"j", "=", 
             RowBox[{"j", "+", 
              RowBox[{"2", "/", "n2"}]}]}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"pointset3d", ",", 
               RowBox[{"surface", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"u", "\[Rule]", "i"}], ",", 
                  RowBox[{"v", "\[Rule]", "j"}]}], "}"}]}]}], "]"}], ";"}]}], 
           "\n", "]"}]}], "]"}], ";", "\[IndentingNewLine]", "pointset3d"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TwoD", "=", 
     RowBox[{"discretize", "[", 
      RowBox[{"7", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Delaunay", " ", "triangulation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Meshpts", "=", " ", 
     RowBox[{"DelaunayMesh", "[", "TwoD", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"triangles", " ", "=", " ", 
     RowBox[{"MeshCells", "[", 
      RowBox[{"Meshpts", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trisnum", " ", "=", " ", 
     RowBox[{"Length", "[", "triangles", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ThreeD", "=", 
     RowBox[{"discretize3D", "[", 
      RowBox[{"7", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X0", "=", "ThreeD"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dat", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Polygon", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"X0", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"X0", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"X0", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
            "]"}]}], "}"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "trisnum"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotAli", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", "dat"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axis1", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axis2", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axis3", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axesL", "=", "3.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tubeT", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotAxes", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Arrowheads", "[", "Automatic", "]"}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"axis1", "*", "axesL"}]}], "}"}], ",", "tubeT"}], "]"}], 
         "]"}], ",", "Green", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"axis2", "*", "axesL"}]}], "}"}], ",", "tubeT"}], "]"}], 
         "]"}], ",", "Blue", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"axis3", "*", "axesL"}]}], "}"}], ",", "tubeT"}], "]"}], 
         "]"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot1", "=", 
     RowBox[{"Show", "[", 
      RowBox[{"plotAli", ",", "plotAxes"}], "]"}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{"Plot", " ", "X0"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Random", " ", "rotation", " ", "to", " ", "X0", " ", "to", " ", "give", 
     " ", "X"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rot2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"Pi", "/", "4"}], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"Pi", "/", "4"}], "]"}]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"Pi", "/", "4"}], "]"}], ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"Pi", "/", "4"}], "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rot", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"Pi", "/", "4"}], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"Pi", "/", "4"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Sin", "[", 
          RowBox[{"Pi", "/", "4"}], "]"}], ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"Pi", "/", "4"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ThreeD", "=", 
     RowBox[{"ThreeD", ".", "Rot2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ThreeD", "=", 
     RowBox[{"ThreeD", ".", "Rot"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", "ThreeD"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dat2", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Polygon", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ThreeD", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"ThreeD", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"ThreeD", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
            "]"}]}], "}"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "trisnum"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotAli2", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", "dat2"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "PCA", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ThreeD", "=", 
     RowBox[{"X", "-", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "ThreeD", "]"}], ",", 
        RowBox[{"Length", "[", "ThreeD", "]"}]}], "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Mean", " ", "center", " ", "X", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cov", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "ThreeD", "]"}], ".", "ThreeD"}]}], ";"}], 
   "   ", 
   RowBox[{"(*", 
    RowBox[{"Covariance", " ", "matrix", " ", "for", " ", "PCA"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eval", "=", 
     RowBox[{"Eigenvalues", "[", "cov", "]"}]}], ";"}], "     ", 
   RowBox[{"(*", 
    RowBox[{"Eigenvalues", " ", "of", " ", "covariance", " ", "matrix"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Evec", "=", 
     RowBox[{"Eigenvectors", "[", "cov", "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"Eigenvectors", " ", "of", " ", "covariance", " ", "matrix"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Plot", " ", "X", " ", "with", " ", "eigen", " ", "vectors", " ", "and", 
     " ", "coordinate", " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotEigenVecs", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"Magenta", ",", 
        RowBox[{"Arrowheads", "[", "Automatic", "]"}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Evec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "axesL"}]}], "}"}], ",", 
           "tubeT"}], "]"}], "]"}], ",", "Yellow", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Evec", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", "axesL"}]}], "}"}], ",", 
           "tubeT"}], "]"}], "]"}], ",", "Cyan", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Evec", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", "axesL"}]}], "}"}], ",", 
           "tubeT"}], "]"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", "=", 
     RowBox[{"Show", "[", 
      RowBox[{"plotAli2", ",", "plotEigenVecs", ",", "plotAxes"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Form", " ", "Y", " ", "matrix", " ", "in", " ", "new", " ", 
     "dimensional", " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ThreeD", "=", 
     RowBox[{"ThreeD", ".", "Evec"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", "=", "ThreeD"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dat3", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Polygon", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ThreeD", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"ThreeD", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"ThreeD", "[", 
            RowBox[{"[", 
             RowBox[{"triangles", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], 
            "]"}]}], "}"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "trisnum"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotAli3", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", "dat3"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot3", "=", 
     RowBox[{"Show", "[", 
      RowBox[{"plotAli3", ",", "plotEigenVecs", ",", "plotAxes"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot4", "=", 
     RowBox[{"Show", "[", "plotAli3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varx", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vary", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varz", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "ThreeD", "]"}]}], ",", 
      RowBox[{"i", "=", 
       RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eachpt", "=", 
        RowBox[{"ThreeD", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"eachpt", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"y", "=", 
        RowBox[{"eachpt", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"z", "=", 
        RowBox[{"eachpt", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"varx", "+=", " ", 
        RowBox[{
         RowBox[{"x", "*", 
          RowBox[{"Evec", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"x", "*", 
          RowBox[{"Evec", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vary", "+=", " ", 
        RowBox[{
         RowBox[{"y", "*", 
          RowBox[{"Evec", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"y", "*", 
          RowBox[{"Evec", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"varz", "+=", " ", 
        RowBox[{
         RowBox[{"z", "*", 
          RowBox[{"Evec", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"z", "*", 
          RowBox[{"Evec", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", " ", "results"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Centroid of the 3D point cloud   \>\"", ",", 
      RowBox[{"Mean", "[", "X", "]"}], ",", "\"\<\\n\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Covariance matrix formed by the 3D point cloud   \>\"", ",", 
      RowBox[{"cov", "//", "MatrixForm"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Eigenvalues of the covariance matrix   \>\"", ",", "Eval"}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Eigenvectors of the covariance matrix.Each column corresponds to \
eigenvector along an axis:\>\"", ",", 
      RowBox[{
       RowBox[{"Transpose", "[", "Evec", "]"}], "//", "MatrixForm"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Variance associated with 1st eigenvector is    \>\"", ",", "varx"}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Variance associated with 2st eigenvector is     \>\"", ",", 
      "vary"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Variance associated with 3st eigenvector is     \>\"", ",", 
      "varz"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"PLot", " ", "the", " ", "X0"}], ",", 
     RowBox[{"X", " ", "and", " ", "Y"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plot1", ",", "plot2", ",", "plot3"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.748275678510296*^9, 3.7482758268929048`*^9}, {
   3.748275896700683*^9, 3.7482759850164566`*^9}, {3.74827602109523*^9, 
   3.7482761383422146`*^9}, {3.7482761841324773`*^9, 
   3.7482766594951763`*^9}, {3.748276700058855*^9, 3.7482767738074093`*^9}, {
   3.7482768401827354`*^9, 3.7482768429016542`*^9}, {3.748280932850455*^9, 
   3.748281023616723*^9}, {3.7482810567661257`*^9, 3.7482810764777265`*^9}, {
   3.748281173118129*^9, 3.7482812570346437`*^9}, {3.7482813748682847`*^9, 
   3.7482814362040434`*^9}, {3.7482814848154087`*^9, 3.7482815855554843`*^9}, 
   3.7482816941987267`*^9, {3.7482817385835233`*^9, 3.748281758829012*^9}, {
   3.748286233656389*^9, 3.74828641832014*^9}, {3.7482864914047947`*^9, 
   3.7482865381784954`*^9}, {3.748286657009409*^9, 3.7482866773805428`*^9}, {
   3.7482867231091785`*^9, 3.748286795415556*^9}, {3.7482868288252277`*^9, 
   3.748286829240834*^9}, {3.748286877076537*^9, 3.7482869570331793`*^9}, {
   3.748287048882326*^9, 3.7482871152554564`*^9}, {3.7482876056516786`*^9, 
   3.7482876479369464`*^9}, {3.748287839068787*^9, 3.748288065648402*^9}, {
   3.748288097917962*^9, 3.7482881042208424`*^9}, {3.7482881669522543`*^9, 
   3.7482883704603186`*^9}, {3.748288419671774*^9, 3.748288494640828*^9}, {
   3.748288544573437*^9, 3.748288560265452*^9}, {3.7482886934363437`*^9, 
   3.748288766613317*^9}, {3.748288814358137*^9, 3.74828888725284*^9}, {
   3.7482889279262333`*^9, 3.7482890120402565`*^9}, {3.748289052364808*^9, 
   3.748289081576681*^9}, {3.748289153156488*^9, 3.748289183469776*^9}, {
   3.748289224123717*^9, 3.748289250641376*^9}, {3.748289339190606*^9, 
   3.7482894510802774`*^9}, {3.7482894889580183`*^9, 
   3.7482894961614375`*^9}, {3.748289548640624*^9, 3.748289618517645*^9}, {
   3.7482896542574835`*^9, 3.748289711680492*^9}, {3.748301516457982*^9, 
   3.7483015259015656`*^9}},
 CellLabel->
  "In[926]:=",ExpressionUUID->"06578bf7-496d-4c7e-8587-bb1cc98f7e00"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part 3: 3D Triangulation Normals", "Chapter",
 CellChangeTimes->{{3.7483057546017747`*^9, 
  3.74830577065224*^9}},ExpressionUUID->"6f531930-72ba-4ee9-9935-\
d538b29c564a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Facenormal", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"points", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"centroid", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "trisnum"}], ",", 
      RowBox[{"i", "=", 
       RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", 
          RowBox[{"triangles", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", 
          RowBox[{"triangles", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", 
          RowBox[{"triangles", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"centroid", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p1", "+", "p2", "+", "p3"}], ")"}], "/", "3"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"points", ",", "p1"}], "]"}], ",", ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"points", ",", "p1"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"points", ",", "p2"}], "]"}], ",", ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"points", ",", "p2"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"points", ",", "p3"}], "]"}], ",", ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"points", ",", "p3"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fn", "=", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"p2", "-", "p1"}], ",", 
          RowBox[{"p3", "-", "p1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fn", "=", 
        RowBox[{"fn", "/", 
         RowBox[{"Norm", "[", "fn", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"Facenormal", ",", "fn"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Create", " ", "association", " ", "to", " ", "map", " ", "each", " ", 
     "point", " ", "to", " ", "a", " ", "cumulative", " ", "facenormal", " ", 
     "vector", " ", "and", " ", "the", " ", "count", " ", "of", " ", "number",
      " ", "of", " ", "times", " ", "it", " ", "occurs", " ", "in", " ", 
     "triangles"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assoc", "=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cnt", "=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "points", "]"}]}], ",", 
      RowBox[{"i", "=", 
       RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"curpt", "=", 
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"assoc", ",", 
         RowBox[{"curpt", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.0", ",", "0.0", ",", "0.0"}], "}"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"cnt", ",", 
         RowBox[{"curpt", "\[Rule]", "0"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "trisnum"}], ",", 
      RowBox[{"i", "=", 
       RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", 
          RowBox[{"triangles", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", 
          RowBox[{"triangles", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"Y", "[", 
         RowBox[{"[", 
          RowBox[{"triangles", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "[", "p1", "]"}], "+=", 
        RowBox[{"Facenormal", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "[", "p2", "]"}], "+=", 
        RowBox[{"Facenormal", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "add", " ", "facenormal", " ", "to", " ", "a", " ", "point", " ", 
         "if", " ", "present", " ", "in", " ", "triangle"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "[", "p3", "]"}], "+=", 
        RowBox[{"Facenormal", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cnt", "[", "p1", "]"}], "=", 
        RowBox[{
         RowBox[{"cnt", "[", "p1", "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cnt", "[", "p2", "]"}], "=", 
        RowBox[{
         RowBox[{"cnt", "[", "p2", "]"}], "+", "1"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "increase", " ", "number", " ", "of", " ", "occurence", " ", "of", 
         " ", "given", " ", "point", " ", "in", " ", "mesh"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cnt", "[", "p3", "]"}], "=", 
        RowBox[{
         RowBox[{"cnt", "[", "p3", "]"}], "+", "1"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "points", "]"}]}], ",", 
      RowBox[{"i", "=", 
       RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"curpt", "=", 
        RowBox[{"points", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assoc", "[", "curpt", "]"}], "=", 
        RowBox[{
         RowBox[{"assoc", "[", "curpt", "]"}], "/", 
         RowBox[{"cnt", "[", "curpt", "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"center", "=", 
     RowBox[{"Mean", "[", "Y", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vertexnormals", "=", 
     RowBox[{"Values", "[", "assoc", "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "Contains", " ", "the", " ", "list", " ", "of", " ", "vertex", " ", 
     "normals", " ", "as", " ", "the", " ", "averaged", " ", "face", " ", 
     "normals", " ", "over", " ", "the", " ", "neighbours"}], "  ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Vertex Normals are\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{"plot4", ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"Vertexnormals", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "Vertexnormals", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Face normals are\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"{", 
     RowBox[{"plot4", ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"centroid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"Facenormal", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "Facenormal", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.748275678510296*^9, 3.7482758268929048`*^9}, {
   3.748275896700683*^9, 3.7482759850164566`*^9}, {3.74827602109523*^9, 
   3.7482761383422146`*^9}, {3.7482761841324773`*^9, 
   3.7482766594951763`*^9}, {3.748276700058855*^9, 3.7482767738074093`*^9}, {
   3.7482768401827354`*^9, 3.7482768429016542`*^9}, {3.748280932850455*^9, 
   3.748281023616723*^9}, {3.7482810567661257`*^9, 3.7482810764777265`*^9}, {
   3.748281173118129*^9, 3.7482812570346437`*^9}, {3.7482813748682847`*^9, 
   3.7482814362040434`*^9}, {3.7482814848154087`*^9, 3.7482815855554843`*^9}, 
   3.7482816941987267`*^9, {3.7482817385835233`*^9, 3.748281758829012*^9}, {
   3.748286233656389*^9, 3.74828641832014*^9}, {3.7482864914047947`*^9, 
   3.7482865381784954`*^9}, {3.748286657009409*^9, 3.7482866773805428`*^9}, {
   3.7482867231091785`*^9, 3.748286795415556*^9}, {3.7482868288252277`*^9, 
   3.748286829240834*^9}, {3.748286877076537*^9, 3.7482869570331793`*^9}, {
   3.748287048882326*^9, 3.7482871152554564`*^9}, {3.7482876056516786`*^9, 
   3.7482876479369464`*^9}, {3.748287839068787*^9, 3.748288065648402*^9}, {
   3.748288097917962*^9, 3.7482881042208424`*^9}, {3.7482881669522543`*^9, 
   3.7482883704603186`*^9}, {3.748288419671774*^9, 3.748288494640828*^9}, {
   3.748288544573437*^9, 3.748288560265452*^9}, {3.7482886934363437`*^9, 
   3.748288766613317*^9}, {3.748288814358137*^9, 3.74828888725284*^9}, {
   3.7482889279262333`*^9, 3.7482890120402565`*^9}, {3.748289052364808*^9, 
   3.748289081576681*^9}, {3.748289153156488*^9, 3.748289183469776*^9}, {
   3.748289224123717*^9, 3.748289250641376*^9}, {3.748289339190606*^9, 
   3.7482894510802774`*^9}, {3.7482894889580183`*^9, 
   3.7482894961614375`*^9}, {3.748289548640624*^9, 3.748289618517645*^9}, {
   3.7482896542574835`*^9, 3.748289711680492*^9}, {3.7482897573550777`*^9, 
   3.7482897632177453`*^9}, {3.748289795284569*^9, 3.7482898076864185`*^9}, {
   3.7482898510707455`*^9, 3.7482899201723046`*^9}, {3.7482900052916994`*^9, 
   3.748290088509621*^9}, {3.748290124453521*^9, 3.748290266603753*^9}, {
   3.7482904538152943`*^9, 3.748290511679594*^9}, {3.748290542026292*^9, 
   3.7482905787477922`*^9}, {3.748290965184622*^9, 3.7482909839570937`*^9}, 
   3.7482910366160784`*^9, {3.7482923252852106`*^9, 3.748292339207762*^9}, {
   3.7482926570368257`*^9, 3.7482928392618237`*^9}, {3.7482932689745646`*^9, 
   3.7482932872938967`*^9}, {3.7482933720307603`*^9, 3.748293389584058*^9}, {
   3.748293431678502*^9, 3.748293442845129*^9}, {3.748293542927345*^9, 
   3.7482935566884584`*^9}, {3.748293606261091*^9, 3.748293693289525*^9}, {
   3.748293752054413*^9, 3.7482938148164425`*^9}, {3.748293974074627*^9, 
   3.748294102362121*^9}, {3.748294140782769*^9, 3.7482943217075777`*^9}, {
   3.7482943612255473`*^9, 3.7482943929446325`*^9}, {3.748294433445763*^9, 
   3.7482944510169487`*^9}, {3.7482945033916135`*^9, 
   3.7482945929483976`*^9}, {3.748294678380056*^9, 3.7482946831666737`*^9}, {
   3.748294730584961*^9, 3.748294765295429*^9}, {3.7482948054552546`*^9, 
   3.748294857209103*^9}, {3.748294960589484*^9, 3.7482949609957557`*^9}, {
   3.7482950809726305`*^9, 3.7482950950629587`*^9}, {3.7482951991096673`*^9, 
   3.748295327509866*^9}, {3.7482953725093994`*^9, 3.748295403760883*^9}, {
   3.7482954535951204`*^9, 3.7482955337608814`*^9}, {3.748295594454851*^9, 
   3.7482956422769127`*^9}, {3.7482957861397343`*^9, 
   3.7482960506900845`*^9}, {3.7482960864471107`*^9, 
   3.7482961191943445`*^9}, {3.748296161427605*^9, 3.748296307949749*^9}, {
   3.7482964815655437`*^9, 3.7482967585310645`*^9}, {3.748296789503817*^9, 
   3.7482968934543605`*^9}, {3.748296955723878*^9, 3.7482974640922947`*^9}, {
   3.7482975115494547`*^9, 3.748297664685199*^9}, {3.748297802977594*^9, 
   3.7482978859650335`*^9}, {3.7482979691299763`*^9, 
   3.7482980056265793`*^9}, {3.7482980528901873`*^9, 
   3.7482980571143093`*^9}, {3.7482981726391735`*^9, 
   3.7482983166757994`*^9}, {3.748298357131318*^9, 3.748298626839057*^9}, {
   3.748298662875128*^9, 3.7482988177957077`*^9}, {3.7482989059719253`*^9, 
   3.7482989296778173`*^9}, {3.748299396489218*^9, 3.7482994258116293`*^9}, {
   3.7482994780377793`*^9, 3.748299497341308*^9}, {3.7482995285431485`*^9, 
   3.748299571933243*^9}, {3.7482996904891157`*^9, 3.748299728583412*^9}, {
   3.7482998796204853`*^9, 3.7483002826946945`*^9}, {3.7483003297517967`*^9, 
   3.748300357663769*^9}, {3.7483004084163017`*^9, 3.748300415568147*^9}, {
   3.748300455450742*^9, 3.748300464333333*^9}, {3.7483005036763783`*^9, 
   3.7483006951703553`*^9}, {3.748300790174632*^9, 3.7483008303879433`*^9}, {
   3.7483009688346343`*^9, 3.7483009690694757`*^9}, 3.7483025691454964`*^9, {
   3.7483026068495636`*^9, 3.748302623255765*^9}, {3.748302704934598*^9, 
   3.7483027113857956`*^9}, {3.7483027488014364`*^9, 3.74830276909208*^9}, {
   3.7483028044089355`*^9, 3.7483029199774475`*^9}, {3.748302958054242*^9, 
   3.7483029934400854`*^9}, {3.7483031846834445`*^9, 3.748303344681837*^9}, {
   3.748303771105298*^9, 3.7483037749507146`*^9}, {3.748303880675841*^9, 
   3.748303934096105*^9}, {3.7483039647390327`*^9, 3.748304094391114*^9}, {
   3.7483042052135715`*^9, 3.7483042569170165`*^9}, {3.748304328015874*^9, 
   3.748304360618512*^9}, {3.748304421651033*^9, 3.7483046039847283`*^9}, {
   3.7483046354973516`*^9, 3.748304800027921*^9}, {3.7483048974206314`*^9, 
   3.7483049107513485`*^9}, {3.7483049881841145`*^9, 
   3.7483050994154186`*^9}, {3.748305133579109*^9, 3.7483051537154427`*^9}, {
   3.748305189281144*^9, 3.7483052336932106`*^9}, {3.7483052776097593`*^9, 
   3.748305297831191*^9}, {3.748305346542675*^9, 3.748305417715494*^9}, {
   3.748305456602476*^9, 3.7483055092924833`*^9}, {3.7483055469346867`*^9, 
   3.748305592064883*^9}, {3.7483056541145926`*^9, 3.7483056811074963`*^9}, {
   3.7483058159071093`*^9, 3.7483058210484533`*^9}, {3.748307849929159*^9, 
   3.748307892320426*^9}},
 CellLabel->
  "In[1451]:=",ExpressionUUID->"69412ca2-646a-4eb0-adab-f63d0ae8a993"],

Cell["\<\
Analysis of deviation of calculated vertex normals from true vertex normals:

 The true vertex normals may differ in direction from the calculated ones \
since we take the cross product during the calculation.We either get the \
outward normal or the inward one.In this scenario,the normals face inward \
.This could be one way in which the true normals differ from the calculated \
ones,in terms of direction of vectors.\
\>", "Text",
 CellChangeTimes->{{3.74830583355478*^9, 3.7483059371845074`*^9}, {
  3.748306034596897*^9, 
  3.7483060360532207`*^9}},ExpressionUUID->"2e7d1681-9437-4811-a63b-\
6e67e477755f"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1351, 685},
WindowMargins->{{Automatic, 7}, {Automatic, 0}},
WindowStatusArea->None,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 183, 6, 156, "Title",ExpressionUUID->"4b370792-d243-4097-bb1e-9a3cd9789aaa"],
Cell[CellGroupData[{
Cell[788, 32, 189, 6, 113, "Chapter",ExpressionUUID->"5aa7b981-d2ec-45da-8141-1737ba0a6862"],
Cell[980, 40, 9415, 174, 485, "Input",ExpressionUUID->"383b79bd-8ca3-4b26-a5c4-4a7f2920a303"],
Cell[10398, 216, 3534, 79, 371, "Input",ExpressionUUID->"3f2b1141-2c1e-46b4-a4dd-b4557e045414"],
Cell[13935, 297, 3039, 47, 105, "Input",ExpressionUUID->"0655997c-bf07-40ca-8a82-97dc34dd521c"],
Cell[16977, 346, 171, 2, 28, "Input",ExpressionUUID->"6f3a9a41-4905-4769-b7a9-e37642735dd7"],
Cell[17151, 350, 6119, 131, 257, "Input",ExpressionUUID->"af4564f0-1436-4e32-9e5c-b861498acc76"],
Cell[23273, 483, 17254, 355, 1131, "Input",ExpressionUUID->"3ea02795-7455-4cca-8962-7c89dadc849a"],
Cell[40530, 840, 10869, 205, 523, "Input",ExpressionUUID->"ca468cd8-c87c-499a-8522-270d7105c740"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51436, 1050, 199, 3, 67, "Chapter",ExpressionUUID->"34763baa-b91a-4e6e-b37e-958a9a0333da"],
Cell[51638, 1055, 21776, 571, 1948, "Input",ExpressionUUID->"06578bf7-496d-4c7e-8587-bb1cc98f7e00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73451, 1631, 178, 3, 67, "Chapter",ExpressionUUID->"6f531930-72ba-4ee9-9935-d538b29c564a"],
Cell[73632, 1636, 15712, 338, 1074, "Input",ExpressionUUID->"69412ca2-646a-4eb0-adab-f63d0ae8a993"],
Cell[89347, 1976, 623, 12, 100, "Text",ExpressionUUID->"2e7d1681-9437-4811-a63b-6e67e477755f"]
}, Open  ]]
}, Open  ]]
}
]
*)

